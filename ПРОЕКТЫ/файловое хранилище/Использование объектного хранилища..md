
    
Возможно у клиента уже будет настроено свое объектное хранилище.  
Довольно часто используются такие хранилища как MINIO.

##### Почему используют объектные хранилища , в частности MinIO, и какие преимущества перед файловой системой

1. Масштабируемость
2. Облачная совместимость (S3 API)
3. Целостность данных
4. Шифрование данных
5. Высокая отказоустойчивость
6. Легкость резервного копирования
7. Оптимизация под большие файлы

  
Если использовать S3-хранилище, потребуется хранить и управлять дополнительными метаданными, чтобы организовать доступ к файлам.

### **Что нужно хранить для каждого файла?**

1. **Bucket Name** – название бакета, где находится файл.
2. **Object Key (Path)** – уникальный путь (ключ) файла в бакете.
3. **Version ID (если включена версионность)** – идентификатор версии файла.
4. **ETag (хеш-код файла)** – для проверки целостности файла.
5. **Content Type** – MIME-тип файла.

### **Что нужно хранить для хранилища в целом?**

1. **S3 Endpoint** – адрес API хранилища (например, `https://s3.merp.com` 
2. **Access Key ID и Secret Access Key** – для аутентификации (лучше хранить безопасно, например, в отдельном хранилище конфигурации).
3. **Bucket Name (если один бакет на всю систему)**.
4. **Политики доступа** – какие пользователи могут загружать/удалять файлы.
5. **Настройки версионности** – включена ли поддержка версии файлов.
6. **Настройки шифрования** – требуется ли серверное шифрование данных (например, SSE-S3, SSE-KMS).
7. **Квоты и ограничения** – если хранилище имеет лимиты по объёму.

### **Как организовать доступ?**

- Использовать **AWS SDK for C++** или REST API для взаимодействия с S3.
- Реализовать механизм **генерации временных ссылок (presigned URLs)**, если файлы нужны без прямого доступа к API.
- Настроить **политики IAM**, чтобы ограничивать доступ к файлам по ролям и пользователям. (Возможно это есть у клиента.)
- Если файлы зашифрованы, хранить ключи в **KMS или другом безопасном хранилище**.  
    
  **Расшифровка терминов:**
- ETag – это MD5-хеш содержимого файла (если серверное шифрование не используется).
- MIME-тип файла, который указывает, какой тип данных хранится в объекте. помогает браузерам и клиентам правильно его обработать.

#### **Примеры MIME-типов:**

| Расширение | MIME-тип         |
|------------|------------------|
| `.txt`       | `text/plain`       |
| `.jpg`       | `image/jpeg`       |
| `.png`       | `image/png`        |
| `.pdf`       | `application/pdf`  |
| `.json`      | `application/json` |

**Вывод**. для поддержки MINIO требуется предусмотреть хранение следующих данных:

1. Для хранилища
   1. S3 Endpoint – адрес API хранилища (например, `https://s3.merp.com` 
   2. Access Key ID и Secret Access Key – для аутентификации приложения в хранилище.
   3. Bucket Name для всей системы или отдельных модулей.
2. Для файлов.
   4. Bucket Name – название бакета, где находится файл.
   5. Object Key (Path) – уникальный путь (ключ) файла в бакете.
   6. ETag (хеш-код файла) – для проверки целостности файла.
   7. Content Type – MIME-тип файла.