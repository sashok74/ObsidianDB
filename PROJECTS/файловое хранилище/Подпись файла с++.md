–ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –±–µ–∑ –ö–≠–ü (–∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏) –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ **–∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏** (RSA, ECDSA) –∏–ª–∏ **—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Å HMAC**. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤–∞—Ä–∏–∞–Ω—Ç —Å **RSA**.

## üîπ **–ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è —Ñ–∞–π–ª–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏**

### **1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π (–µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç)**

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–∞—Ä–∞ –∫–ª—é—á–µ–π:

- **–ü—Ä–∏–≤–∞—Ç–Ω—ã–π** (–¥–ª—è –ø–æ–¥–ø–∏—Å–∏).
- **–ü—É–±–ª–∏—á–Ω—ã–π** (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏).

üí° _–ò—Å–ø–æ–ª—å–∑—É–µ–º OpenSSL –≤ C++_

```cpp
openssl genpkey -algorithm RSA -out private_key.pem
openssl rsa -in private_key.pem -pubout -out public_key.pem
```

---

### **2. –ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–∞**

1. –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª –≤ –ø–∞–º—è—Ç—å.
2. –í—ã—á–∏—Å–ª–∏—Ç—å —Ö–µ—à (–Ω–∞–ø—Ä–∏–º–µ—Ä, SHA-256).
3. –ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Ö–µ—à –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –∫–ª—é—á–æ–º (RSA).
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å—å –æ—Ç–¥–µ–ª—å–Ω–æ –∏–ª–∏ –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –∫ —Ñ–∞–π–ª—É.

**C++-–∫–æ–¥ —Å OpenSSL:**

```cpp
#include <openssl/pem.h>
#include <openssl/sha.h>
#include <openssl/rsa.h>
#include <openssl/err.h>
#include <fstream>
#include <vector>

std::vector<unsigned char> signFile(const std::string& filename, const std::string& privateKeyPath) {
    // –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª
    std::ifstream file(filename, std::ios::binary);
    std::vector<unsigned char> data((std::istreambuf_iterator<char>(file)), std::istreambuf_iterator<char>());

    // –•–µ—à–∏—Ä—É–µ–º —Ñ–∞–π–ª (SHA-256)
    unsigned char hash[SHA256_DIGEST_LENGTH];
    SHA256(data.data(), data.size(), hash);

    // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á
    FILE* privKeyFile = fopen(privateKeyPath.c_str(), "r");
    RSA* rsa = PEM_read_RSAPrivateKey(privKeyFile, NULL, NULL, NULL);
    fclose(privKeyFile);

    // –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ–º —Ö–µ—à
    std::vector<unsigned char> signature(RSA_size(rsa));
    unsigned int sigLen;
    RSA_sign(NID_sha256, hash, SHA256_DIGEST_LENGTH, signature.data(), &sigLen, rsa);

    // –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º —Ä–µ—Å—É—Ä—Å—ã
    RSA_free(rsa);

    return signature;
}
```

üìå –ü–æ–¥–ø–∏—Å—å –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª:

```cpp
std::ofstream sigFile("signature.sig", std::ios::binary);
sigFile.write(reinterpret_cast<const char*>(signature.data()), signature.size());
sigFile.close();
```

---

### **3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ**

1. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.
2. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å—å (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ –∏–ª–∏ –≤ –ë–î).
3. –ó–∞–ø–∏—Å–∞—Ç—å –≤ –±–∞–∑—É –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (—Ö–µ—à, –ø–æ–¥–ø–∏—Å—å, –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É).

---

### **4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏**

4. –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª.
5. –í—ã—á–∏—Å–ª–∏—Ç—å –µ–≥–æ —Ö–µ—à (SHA-256).
6. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –ø–æ–¥–ø–∏—Å—å –ø—É–±–ª–∏—á–Ω—ã–º –∫–ª—é—á–æ–º.
7. –°—Ä–∞–≤–Ω–∏—Ç—å —Ö–µ—à–∏.

**C++-–∫–æ–¥ —Å OpenSSL:**

```cpp
bool verifySignature(const std::string& filename, const std::vector<unsigned char>& signature, const std::string& publicKeyPath) {
    // –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª
    std::ifstream file(filename, std::ios::binary);
    std::vector<unsigned char> data((std::istreambuf_iterator<char>(file)), std::istreambuf_iterator<char>());

    // –•–µ—à–∏—Ä—É–µ–º (SHA-256)
    unsigned char hash[SHA256_DIGEST_LENGTH];
    SHA256(data.data(), data.size(), hash);

    // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á
    FILE* pubKeyFile = fopen(publicKeyPath.c_str(), "r");
    RSA* rsa = PEM_read_RSA_PUBKEY(pubKeyFile, NULL, NULL, NULL);
    fclose(pubKeyFile);

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–ø–∏—Å—å
    int result = RSA_verify(NID_sha256, hash, SHA256_DIGEST_LENGTH, signature.data(), signature.size(), rsa);

    RSA_free(rsa);

    return result == 1;
}
```

üìå **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```cpp
std::vector<unsigned char> signature; // –ó–∞–≥—Ä—É–∑–∏ –ø–æ–¥–ø–∏—Å—å –∏–∑ —Ñ–∞–π–ª–∞
bool valid = verifySignature("file.txt", signature, "public_key.pem");

if (valid) {
    std::cout << "–ü–æ–¥–ø–∏—Å—å –≤–µ—Ä–Ω–∞!" << std::endl;
} else {
    std::cout << "–ü–æ–¥–ø–∏—Å—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞!" << std::endl;
}
```

---

## üîπ **–†–µ–∑—É–ª—å—Ç–∞—Ç**

- **–§–∞–π–ª –ø–æ–¥–ø–∏—Å–∞–Ω** –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –∫–ª—é—á–æ–º.
- **–°–æ—Ö—Ä–∞–Ω—ë–Ω** –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏** –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –µ–≥–æ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å.

–≠—Ç–æ **–Ω–µ –ö–≠–ü**, –Ω–æ –∑–∞—â–∏—â–∞–µ—Ç —Ñ–∞–π–ª –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏. üòä