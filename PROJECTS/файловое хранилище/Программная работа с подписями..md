### **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å –∫–ª—é—á–∞–º–∏ –≤ C++ (–ö–≠–ü –∏ –±–µ–∑ –ö–≠–ü)**

–í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±–æ—Ä–∞ **–ö–≠–ü –∏–ª–∏ –±–µ–∑ –ö–≠–ü** –ø–æ–¥—Ö–æ–¥—ã –∫ —Ä–∞–±–æ—Ç–µ —Å –∫–ª—é—á–∞–º–∏ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è.  
–†–∞—Å—Å–º–æ—Ç—Ä–∏–º **–±–∏–±–ª–∏–æ—Ç–µ–∫–∏, —Å–µ—Ä–≤–∏—Å—ã –∏ –æ–±—â–∏–π –æ–±—ä–µ–º —Ä–∞–±–æ—Ç**.
–ü—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã–π –∫–æ–¥ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ä–∞–±–æ—á–∏–º –∞ –≤–∑—è—Ç –∏–∑ –ø—Ä–∏–º–µ—Ä–æ–≤ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
—á—Ç–æ–±—ã –æ—Ü–µ–Ω–∏—Ç—å —Å–ª–æ–∂–Ω–æ—Å—Ç—å. 

---

## **1. –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ —Å–µ—Ä–≤–∏—Å—ã**

| –ó–∞–¥–∞—á–∞                    | –ë–µ–∑ –ö–≠–ü (RSA, ECDSA)     | –° –ö–≠–ü (–ì–û–°–¢)              |
| ------------------------- | ------------------------ | ------------------------- |
| **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π**      | OpenSSL, Crypto++        | –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ CSP, VipNet CSP |
| **–ü–æ–¥–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö**        | OpenSSL, Botan, Crypto++ | –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ CSP, SignalCom  |
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏**      | OpenSSL, Botan           | –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ, OpenSSL+GOST   |
| **–§–æ—Ä–º–∞—Ç –ø–æ–¥–ø–∏—Å–∏**        | RAW, PEM                 | PKCS#7 (CAdES, XAdES)     |
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤** | X.509 (OpenSSL)          | CRL/OCSP (–ö—Ä–∏–ø—Ç–æ–ü—Ä–æ)      |

üîπ **–ï—Å–ª–∏ –±–µ–∑ –ö–≠–ü** ‚Äì –º–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å **—Ç–æ–ª—å–∫–æ —Å OpenSSL/Botan**.  
üîπ **–ï—Å–ª–∏ –ö–≠–ü** ‚Äì –Ω—É–∂–µ–Ω **–ö—Ä–∏–ø—Ç–æ–ü—Ä–æ CSP –∏–ª–∏ VipNet CSP**.

---

## **2. –†–∞–±–æ—Ç–∞ —Å –∫–ª—é—á–∞–º–∏ (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è, –ø–æ–¥–ø–∏—Å—å, –ø—Ä–æ–≤–µ—Ä–∫–∞)**

### **‚úÖ –ë–µ–∑ –ö–≠–ü (RSA, ECDSA, Ed25519)**

üîπ –ò—Å–ø–æ–ª—å–∑—É–µ–º **OpenSSL** (–∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ).

**1Ô∏è‚É£ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π**

```cpp
EVP_PKEY* GenerateKeyPair() {
    EVP_PKEY_CTX* ctx = EVP_PKEY_CTX_new_id(EVP_PKEY_RSA, NULL);
    EVP_PKEY* pkey = NULL;
    EVP_PKEY_keygen_init(ctx);
    EVP_PKEY_CTX_set_rsa_keygen_bits(ctx, 2048);
    EVP_PKEY_keygen(ctx, &pkey);
    EVP_PKEY_CTX_free(ctx);
    return pkey;
}
```

üîπ **RSA/ECDSA –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤ OpenSSL –∏ Botan**.

**2Ô∏è‚É£ –ü–æ–¥–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö**

```cpp
std::string SignData(const std::string& data, EVP_PKEY* privateKey) {
    EVP_MD_CTX* ctx = EVP_MD_CTX_new();
    EVP_DigestSignInit(ctx, NULL, EVP_sha256(), NULL, privateKey);

    size_t sigLen;
    EVP_DigestSign(ctx, NULL, &sigLen, (const unsigned char*)data.c_str(), data.size());

    std::vector<unsigned char> signature(sigLen);
    EVP_DigestSign(ctx, signature.data(), &sigLen, (const unsigned char*)data.c_str(), data.size());

    EVP_MD_CTX_free(ctx);
    return std::string(signature.begin(), signature.end());
}
```

**3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏**

```cpp
bool VerifySignature(const std::string& data, const std::string& signature, EVP_PKEY* publicKey) {
    EVP_MD_CTX* ctx = EVP_MD_CTX_new();
    EVP_DigestVerifyInit(ctx, NULL, EVP_sha256(), NULL, publicKey);

    bool result = EVP_DigestVerify(ctx, (const unsigned char*)signature.c_str(), signature.size(),
                                   (const unsigned char*)data.c_str(), data.size());

    EVP_MD_CTX_free(ctx);
    return result;
}
```

‚úî **–ü–ª—é—Å—ã:** –ü—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å.  
‚ùå **–ú–∏–Ω—É—Å—ã:** –ù–µ—Ç —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏, –Ω—É–∂–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª—é—á–∞–º–∏.

---

### **‚úÖ –° –ö–≠–ü (–ì–û–°–¢ –† 34.10-2012, –ì–û–°–¢ –† 34.11-2012)**

üîπ –ò—Å–ø–æ–ª—å–∑—É–µ–º **–ö—Ä–∏–ø—Ç–æ–ü—Ä–æ CSP** –∏–ª–∏ **VipNet CSP** (—Ç–æ–ª—å–∫–æ Windows).

**1Ô∏è‚É£ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π**

```cmd
csptest -keyset -gen -type exchange -container my_key -provtype 80
```

üîπ –ö–ª—é—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è **–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ**.

**2Ô∏è‚É£ –ü–æ–¥–ø–∏—Å—å —Ñ–∞–π–ª–∞**

```cmd
csptest -sfsign -sign -in file.txt -out file.sig -my "–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" -detached
```

üîπ –ü–æ–¥–ø–∏—Å—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ **PKCS#7 (CAdES-BES, CAdES-T)**.

**3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏**

```cmd
csptest -sfsign -verify -in file.txt -signature file.sig -verifycert
```

üîπ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ü–µ–ø–æ—á–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤, CRL/OCSP.

‚úî **–ü–ª—é—Å—ã:** –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å, —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –≥–æ—Å—Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏.  
‚ùå **–ú–∏–Ω—É—Å—ã:** –¢–æ–ª—å–∫–æ Windows, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ/VipNet.

---

## **3. –ß—Ç–æ –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ?**

| –§—É–Ω–∫—Ü–∏—è                | –ë–µ–∑ –ö–≠–ü                 | –° –ö–≠–ü                       |
| ---------------------- | ----------------------- | --------------------------- |
| **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π**   | OpenSSL (RSA, ECDSA)    | –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ CSP (–ì–û–°–¢)        |
| **–•—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–π**    | –í —Ñ–∞–π–ª–∞—Ö (PEM) –∏–ª–∏ –±–∞–∑–µ | –í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ     |
| **–ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**  | OpenSSL (RAW, PEM)      | PKCS#7 (CAdES)              |
| **–•—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–µ–π**  | –ë–î, JSON                | –§–∞–π–ª—ã `.sig` (PKCS#7)       |
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π**  | OpenSSL                 | CRL, OCSP                   |
| **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–µ–±–æ–º** | WebCrypto API           | –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–π –ø–ª–∞–≥–∏–Ω |

---

## **4. –û–±—ä–µ–º —Ä–∞–±–æ—Ç**

–û—Ü–µ–Ω–∫–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∞ –Ω–∞ –±–∞–∑–µ –ø—Ä–æ–≥—Ä–∞–º–º —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∫–æ–¥–æ–º –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –º–æ–¥—É–ª–µ–π, —Ñ—É–Ω–∫—Ü–∏–π. —Ç.–µ –¥–æ–≤–æ–ª—å–Ω–æ –ø—Ä–∏–º–µ—Ä–Ω–∞—è.

|–ó–∞–¥–∞—á–∞|–ë–µ–∑ –ö–≠–ü|–° –ö–≠–ü|
|---|---|---|
|**–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∫—Ä–∏–ø—Ç–æ–º–æ–¥—É–ª—è**|2-3 –Ω–µ–¥–µ–ª–∏|4-6 –Ω–µ–¥–µ–ª—å|
|**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–µ–±–æ–º**|WebCrypto API|–ö—Ä–∏–ø—Ç–æ–ü—Ä–æ –ø–ª–∞–≥–∏–Ω|
|**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤**|OpenSSL –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ|–ö—Ä–∏–ø—Ç–æ–ü—Ä–æ –Ω–∞ Windows|
|**–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤**|–ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞|CRL/OCSP|

üîπ **–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ö–≠–ü**, –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è **–ö—Ä–∏–ø—Ç–æ–ü—Ä–æ CSP** –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ Windows.  
üîπ **–ï—Å–ª–∏ –±–µ–∑ –ö–≠–ü**, –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å OpenSSL –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –∫–ª–∏–µ–Ω—Ç.

---

## **–í—ã–≤–æ–¥**

‚úî **–ï—Å–ª–∏ –≤–∞–∂–Ω–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å** ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º **–ö—Ä–∏–ø—Ç–æ–ü—Ä–æ CSP (–ì–û–°–¢)**.  
‚úî **–ï—Å–ª–∏ –≤–∞–∂–Ω–∞ –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ—Å—Ç–æ—Ç–∞** ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º **OpenSSL (RSA, ECDSA, Ed25519)**.  
‚úî **–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–æ–≤–º–µ—â–∞—Ç—å –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞**, –º–æ–∂–Ω–æ –¥–∞—Ç—å **–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–±–æ—Ä** –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏.

–ö–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç —Ç–µ–±–µ –±–ª–∏–∂–µ? üöÄ