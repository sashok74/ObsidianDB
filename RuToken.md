### **–ß—Ç–æ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —Å —Ç–æ–∫–µ–Ω–æ–º –≤ –ö—Ä–∏–ø—Ç–æ–ü—Ä–æ CSP?**

–¢–≤–æ–π —Ç–æ–∫–µ–Ω **Aktiv Rutoken Lite** —É—Å–ø–µ—à–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω —Å–∏—Å—Ç–µ–º–æ–π. –¢–µ–ø–µ—Ä—å —Ç—ã –º–æ–∂–µ—à—å:

1Ô∏è‚É£ **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫–∏–µ –∫–ª—é—á–∏ —É–∂–µ –µ—Å—Ç—å –Ω–∞ —Ç–æ–∫–µ–Ω–µ**  
2Ô∏è‚É£ **–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ –∫–ª—é—á–∏**  
3Ô∏è‚É£ **–°–¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç**  
4Ô∏è‚É£ **–ü–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å —Ñ–∞–π–ª—ã —Ç–æ–∫–µ–Ω–æ–º**  
5Ô∏è‚É£ **–ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–¥–ø–∏—Å–∏**

---
–º–æ–π —Ç–æ–∫–µ–Ω:
```cmd
C:\Program Files\Far Manager>csptest -keyset -enum -fqcn                                                                                                                                                CSP (Type:80) v5.0.10013 KC1 Release Ver:5.0.13000 OS:Windows CPU:AMD64 FastCode:READY:AVX,AVX2.                                                                                                        AcquireContext: OK. HCRYPTPROV: 2675718512                                                                                                                                                              \\.\Aktiv Rutoken lite 0\a2b1dfb4c-abb7-dea3-58c1-256b7fb2923                                                                                                                                           \\.\Aktiv Rutoken lite 0\20244051                                                                                                                                                                       OK.                                                                                                                                                                                                     Total: SYS: 0,016 sec USR: 0,000 sec UTC: 0,734 sec                                                                                                                                                     [ErrorCode: 0x00000000] 
```
## **1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –Ω–∞ —Ç–æ–∫–µ–Ω–µ**

üëâ **–ö–∞–∫–∏–µ –∫–ª—é—á–∏ —É–∂–µ –∑–∞–ø–∏—Å–∞–Ω—ã?**


`csptest -keyset -enum -fqcn`

–í—ã–≤–æ–¥ —É —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å, —Ç–æ–∫–µ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç:

CopyEdit

`\\.\Aktiv Rutoken lite 0\a2b1dfb4c-abb7-dea3-58c1-256b7fb2923 \\.\Aktiv Rutoken lite 0\20244051`

–ó–Ω–∞—á–∏—Ç, —É —Ç–µ–±—è **–µ—Å—Ç—å –¥–≤–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞**. –ú–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Ö —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ.

üëâ **–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–∞–Ω–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö:**

`certmgr -list -store uMy`

–ï—Å–ª–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã, —Ç—ã —É–≤–∏–¥–∏—à—å —Å–ø–∏—Å–æ–∫.

---

## **2. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∫–ª—é—á–µ–π –Ω–∞ —Ç–æ–∫–µ–Ω–µ**

üëâ **–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–ì–û–°–¢ –† 34.10-2012)**

cmd

CopyEdit

`csptest -keyset -gen -type exchange -container "\\.\Aktiv Rutoken lite 0\my_container" -provtype 80`

‚úî **–¢–µ–±–µ –ø—Ä–∏–¥–µ—Ç—Å—è –≤–≤–µ—Å—Ç–∏ PIN-–∫–æ–¥** —Ç–æ–∫–µ–Ω–∞.

üëâ **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ–∑–¥–∞–ª—Å—è:**


`csptest -keyset -enum -fqcn`

–î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è **"my_container"**.

---

## **3. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (CSR)**

–ï—Å–ª–∏ —Ç—ã —Ö–æ—á–µ—à—å –ø–æ–ª—É—á–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–ª—è —Ç–æ–∫–µ–Ω–∞, –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å **–∑–∞–ø—Ä–æ—Å –≤ –£–¶**.

üëâ **–°–æ–∑–¥–∞—Ç—å CSR (–∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç)**


`certmgr -request -provtype 80 -container "\\.\Aktiv Rutoken lite 0\my_container" -dn "CN=User" -ku 0xa0`

‚úî –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç CSR-–∑–∞–ø—Ä–æ—Å –∏ –æ—Ç–∫—Ä–æ–µ—Ç GUI –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ –£–¥–æ—Å—Ç–æ–≤–µ—Ä—è—é—â–∏–π –¶–µ–Ω—Ç—Ä (–£–¶).  
‚úî –ü–æ—Å–ª–µ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –£–¶ —Ç—ã —Å–º–æ–∂–µ—à—å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç.

---

## **4. –ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å —Ç–æ–∫–µ–Ω–æ–º**

üëâ **–ü–æ–¥–ø–∏—Å–∞—Ç—å —Ñ–∞–π–ª (`.sig` –ø–æ–¥–ø–∏—Å—å –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç —Ñ–∞–π–ª–∞)**


`csptest -sfsign -sign -in test.txt -out test.txt.sig -my "CN=User" -detached`

‚úî –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø—Ä–æ—Å–∏—Ç **PIN-–∫–æ–¥ —Ç–æ–∫–µ–Ω–∞** –¥–ª—è –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è.  
‚úî –ü–æ–¥–ø–∏—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `test.txt.sig`.

üëâ **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å—å:**

`csptest -sfsign -verify -in test.txt -signature test.txt.sig -verifycert`

‚úÖ –ï—Å–ª–∏ –ø–æ–¥–ø–∏—Å—å –≤–µ—Ä–Ω–∞, –ø–æ–ª—É—á–∏—à—å **"Signature is valid"**.

---

## **5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–æ–∑–≤–∞–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (CRL/OCSP)**

–ï—Å–ª–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω –£–¶, –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ–≥–æ —Å—Ç–∞—Ç—É—Å.

üëâ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ CRL (—Å–ø–∏—Å–æ–∫ –æ—Ç–æ–∑–≤–∞–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤)**

`csptest -url -crl http://crl.cryptopro.ru/crl/ca.crl -verifycert test.cer`

üëâ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ OCSP (–æ–Ω–ª–∞–π–Ω-–∑–∞–ø—Ä–æ—Å –≤ –£–¶)**

`csptest -url -ocsp http://ocsp.cryptopro.ru/ -verifycert test.cer`

---

## **–í—ã–≤–æ–¥**

‚úî –£ —Ç–µ–±—è **—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–∫–µ–Ω**, —Ç—ã –º–æ–∂–µ—à—å:  
‚úî **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã**  
‚úî **–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –∫–ª—é—á–∏**  
‚úî **–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å CSR-–∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç**  
‚úî **–ü–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å —Ñ–∞–π–ª—ã —Ç–æ–∫–µ–Ω–æ–º**

üöÄ **–ß—Ç–æ —Ö–æ—á–µ—à—å –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å?**